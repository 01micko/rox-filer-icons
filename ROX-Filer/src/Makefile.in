SHELL = @SHELL@
srcdir = @srcdir@
PLATFORM_DIR = @bindir@
LIBS = @LIBS@
.SUFFIXES:
.SUFFIXES: .c .o

CC = @CC@
IMLIB_CFLAGS = @IMLIB_CFLAGS@
IMLIB_LIBS = @IMLIB_LIBS@
CFLAGS = @CFLAGS@ `gtk-config --cflags` -I.
LDFLAGS = @LDFLAGS@ `gtk-config --libs` ${LIBS} ${IMLIB_LIBS}
EXEC = ${PLATFORM_DIR}/${PROG}

############ Things to change for different programs

PROG = ROX-Filer

SRCS = action.c bind.c choices.c collection.c dir.c display.c dnd.c filer.c \
	find.c fscache.c gtksavebox.c gui_support.c i18n.c icon.c main.c    \
	menu.c minibuffer.c modechange.c mount.c options.c panel.c	    \
	pinboard.c pixmaps.c remote.c rox_gettext.c run.c support.c	    \
	toolbar.c type.c

OBJECTS = action.o bind.o choices.o collection.o dir.o display.o dnd.o filer.o \
	find.o fscache.o gtksavebox.o gui_support.o i18n.o icon.o main.o    \
	menu.o minibuffer.o modechange.o mount.o options.o panel.o	    \
	pinboard.o pixmaps.o remote.o rox_gettext.o run.o support.o	    \
	toolbar.o type.o


############ Things to keep the same

${EXEC}: ${PLATFORM_DIR} ${OBJECTS}
	${CC} -o ${EXEC} ${OBJECTS} ${LDFLAGS}

${PLATFORM_DIR}:
	mkdir ${PLATFORM_DIR}

clean:
	rm -f *.o Makefile.bak

depend:
	makedepend -- ${CFLAGS} -- ${SRCS}

Makefile: Makefile.in config.status
	./config.status

config.h: config.h.in
	./config.status

config.status: configure
	./configure --bindir=${PLATFORM_DIR}

configure: configure.in
	autoconf

messages.pot: ${SRCS}
	xgettext --keyword=_ --keyword=N_ --output=$@ ${SRCS}

dist:
	(cd po; ./dist)
	echo "Don't forget the manual and version number!"

############ Special case

pixmaps.o: pixmaps.c
	${CC} ${CFLAGS} ${IMLIB_CFLAGS} -c $< -o $@


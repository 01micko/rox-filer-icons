SHELL = @SHELL@
srcdir = @srcdir@
PLATFORM_DIR = @bindir@
LIBS = @LIBS@ @GDK_PIXBUF_LIBS@
.SUFFIXES:
.SUFFIXES: .c .o

CC = @CC@

GTK_CONFIG = @GTK_CONFIG@
GDK_PIXBUF_CONFIG = @GDK_PIXBUF_CONFIG@
CFLAGS = @CFLAGS@ `${GTK_CONFIG} --cflags` -I.
LDFLAGS = @LDFLAGS@ `${GTK_CONFIG} --libs` ${LIBS}
EXEC = ${PLATFORM_DIR}/${PROG}

############ Things to change for different programs

PROG = ROX-Filer

SRCS = action.c appmenu.c bind.c choices.c collection.c dir.c display.c dnd.c \
	filer.c find.c fscache.c gtksavebox.c gui_support.c i18n.c icon.c     \
	main.c menu.c minibuffer.c modechange.c mount.c options.c panel.c     \
	pinboard.c pixmaps.c remote.c rox_gettext.c run.c support.c	      \
	toolbar.c type.c 

OBJECTS = action.c appmenu.c bind.c choices.c collection.c dir.c display.c  \
	dnd.c filer.c find.c fscache.c gtksavebox.c gui_support.c i18n.c    \
	icon.c main.c menu.c minibuffer.c modechange.c mount.c options.c    \
	panel.c	pinboard.c pixmaps.c remote.c rox_gettext.c run.c support.c \
	toolbar.c type.c 

############ Things to keep the same

${EXEC}: ${PLATFORM_DIR} ${OBJECTS}
	${CC} -o ${EXEC} ${OBJECTS} ${LDFLAGS}

${PLATFORM_DIR}:
	mkdir ${PLATFORM_DIR}

clean:
	rm -f *.o Makefile.bak

depend:
	makedepend -- ${CFLAGS} -- ${SRCS}

Makefile: Makefile.in config.status
	./config.status

config.h: config.h.in
	./config.status

config.status: configure
	./configure --bindir=${PLATFORM_DIR}

configure: configure.in
	autoconf

messages.pot: ${SRCS}
	xgettext --keyword=_ --keyword=N_ --output=$@ ${SRCS}

############ Special case

pixmaps.o: pixmaps.c
	${CC} ${CFLAGS} `${GDK_PIXBUF_CONFIG} --cflags` -c $< -o $@
